<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Demo V6 ‚Äî Ganader√≠a Satelital (Pastoreo PV6)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo">üåø</span>
      <div class="brand-txt">
        <strong>Demo V6</strong>
        <small>Pastoreo PV6 ¬∑ Kg MS/ha</small>
      </div>
    </div>
    <div class="kpis kpis-finca">
      <div class="kpi"><div class="kpi-label">Kg MS/ha ponderado (Finca)</div><div id="kpi-biomasa-finca" class="kpi-value">‚Äì</div></div>
      <div class="kpi"><div class="kpi-label">√Årea total (Finca)</div><div id="kpi-area-finca" class="kpi-value">‚Äì</div></div>
      <div class="kpi"><div class="kpi-label">N cabezas (Finca)</div><div id="kpi-n-finca" class="kpi-value">‚Äì</div></div>
      <div class="kpi"><div class="kpi-label">Oferta utilizable (Finca)</div><div id="kpi-oferta-finca" class="kpi-value">‚Äì</div></div>
      <div class="kpi"><div class="kpi-label">Demanda diaria (Finca)</div><div id="kpi-demanda-finca" class="kpi-value">‚Äì</div></div>
      <div class="kpi"><div class="kpi-label">D√≠as recomendados (Finca)</div><div id="kpi-dias-finca" class="kpi-value">‚Äì</div></div>
    </div>
  </header>

  <section class="kpis kpis-potrero">
    <div class="kpi"><div class="kpi-label">Potrero seleccionado</div><div id="kpi-potrero-nombre" class="kpi-value">‚Äî</div></div>
    <div class="kpi"><div class="kpi-label">Kg MS/ha (Potrero)</div><div id="kpi-biomasa-pot" class="kpi-value">‚Äî</div></div>
    <div class="kpi"><div class="kpi-label">√Årea (ha)</div><div id="kpi-area-pot" class="kpi-value">‚Äî</div></div>
    <div class="kpi"><div class="kpi-label">N cabezas (Potrero)</div><div id="kpi-n-pot" class="kpi-value">‚Äî</div></div>
    <div class="kpi"><div class="kpi-label">Oferta utilizable (Potrero)</div><div id="kpi-oferta-pot" class="kpi-value">‚Äî</div></div>
    <div class="kpi"><div class="kpi-label">D√≠as recomendados (Potrero)</div><div id="kpi-dias-pot" class="kpi-value">‚Äî</div></div>
  </section>

  <main class="main">
    <div id="map"></div>

    <aside class="side">
      <section class="pastoreo-dynamic">
        <div>
          <div class="pill state-green">Ocupados</div>
          <div id="chips-green" class="chips"></div>
        </div>
        <div>
          <div class="pill">Libres calificados</div>
          <div id="chips-yellow" class="chips"></div>
        </div>
      </section>

      <div class="card">
        <div class="card-header">
          <h3>Serie temporal (Kg MS/ha & P‚ÄìETo)</h3>
          <button id="expand-chart" class="btn secondary">Expandir</button>
        </div>
        <div class="chart-wrap">
          <canvas id="timeseries"></canvas>
        </div>
      </div>

      <div class="panel">
        <div class="panel-head">
          <h4>Ranking de potreros (Pastoreo)</h4>
        </div>
        <div class="table-wrap">
          <table class="rank">
            <thead>
              <tr>
                <th>Potrero</th>
                <th>Kg MS/ha</th>
                <th>Pend.7d</th>
                <th>FND</th>
                <th>Descanso</th>
                <th>Entrada</th>
                <th>D√≠as br.</th>
                <th>D√≠as aj.</th>
                <th>Estado</th>
              </tr>
            </thead>
            <tbody id="rank-body"></tbody>
          </table>
        </div>
      </div>

      <!-- Card PV6 Manejo (se inyecta contenido con pv6_m2_addon_v216.js) -->
      <section id="pv6-manejo-card" class="card"></section>
    </aside>
  </main>

  <!-- Librer√≠as -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- IMPORTANTE: El parche remoto debe cargarse ANTES del app para interceptar MOV -->
  <script>
    window.__PV6_SHEETS_MOV_URL__ = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR_Rp6f-Xdv6RyWXQhY0uV1E5P3PBQpjMJIVrxeRAq4RCYMEzlqWY24Jltqstcp3uV79moaJc63d4cf/pub?gid=0&single=true&output=csv";
  </script>
  <script src="pv6_mov_remote_patch.js"></script>

  <!-- N√∫cleo de tu app (deja tu archivo actual con l√≥gica de mapa/series) -->
  <script src="app.v6.js"></script>

  <!-- Addons PV6 -->
  <script src="pv6_m1_addon.js"></script>
  <script src="pv6_m2_addon_v216.js"></script>
  <script src="pv6_m3_fdn_waste_patch.js"></script>
</body>
</html>
